<section class="container">
  <header>
    <h1>Welcome to Your Team To-Do List</h1>
    <p>Manage your tasks efficiently with your team.</p>

    <section class="actions">
      <button mat-raised-button color="primary" (click)="createTask()">
        Create New Task
      </button>

      <mat-checkbox [(ngModel)]="showMyTasks" (change)="applyFilters()">
        View my tasks
      </mat-checkbox>

      <mat-checkbox [(ngModel)]="showCompletedTasks" (change)="applyFilters()">
        View completed tasks
      </mat-checkbox>
    </section>
  </header>

  <table mat-table [dataSource]="pagedTasks" class="mat-elevation-z8">
    <!-- Title Column -->
    <ng-container matColumnDef="title">
      <th mat-header-cell *matHeaderCellDef>Title</th>
      <td mat-cell *matCellDef="let task">
        <a class="task-title" (click)="showTaskDetails(task)">
          {{ task.title }}
        </a>
      </td>
    </ng-container>

    <!-- Assigned To Column -->
    <ng-container matColumnDef="assignedTo">
      <th mat-header-cell *matHeaderCellDef>Assigned To</th>
      <td mat-cell *matCellDef="let task">{{ task.assignedTo }}</td>
    </ng-container>

    <!-- Edit Column -->
    <ng-container matColumnDef="edit">
      <th mat-header-cell *matHeaderCellDef>Edit</th>
      <td mat-cell *matCellDef="let task; let i = index">
        <button mat-icon-button (click)="editTask(i)">
          <mat-icon>edit</mat-icon>
        </button>
      </td>
    </ng-container>

    <!-- Delete Column -->
    <ng-container matColumnDef="delete">
      <th mat-header-cell *matHeaderCellDef>Delete</th>
      <td mat-cell *matCellDef="let task; let i = index">
        <button mat-icon-button (click)="deleteTask(i)">
          <mat-icon>delete</mat-icon>
        </button>
      </td>
    </ng-container>

    <!-- Completed Column -->
    <ng-container matColumnDef="completed">
      <th mat-header-cell *matHeaderCellDef>Completed</th>
      <td mat-cell *matCellDef="let task; let i = index">
        <mat-checkbox
          [(ngModel)]="task.completed"
          (change)="toggleCompletion(i)"
        >
        </mat-checkbox>
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
  </table>

  <mat-paginator [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons>
  </mat-paginator>
</section>

<app-task-modal
  [show]="showTaskModal"
  [isEditMode]="isEditMode"
  [task]="taskForm"
  [teamMembers]="teamMembers"
  (save)="submitTask($event)"
  (close)="closeModal()"
></app-task-modal>

<!-- Delete Confirmation Modal -->
<section class="modal-backdrop" *ngIf="showDeleteModal">
  <section class="modal">
    <h2>Confirm Delete</h2>
    <p>Are you sure you want to delete this task?</p>
    <p>"{{ taskToDelete.title }}" assigned to {{ taskToDelete.assignedTo }}</p>
    <section class="modal-actions">
      <button class="cancel-delete" (click)="cancelDelete()">Cancel</button>
      <button class="delete" (click)="confirmDelete()">Delete</button>
    </section>
  </section>
</section>

<!-- Task Details Modal -->
<app-task-details-modal
  [task]="selectedTask"
  (close)="closeTaskDetails()"
></app-task-details-modal>
